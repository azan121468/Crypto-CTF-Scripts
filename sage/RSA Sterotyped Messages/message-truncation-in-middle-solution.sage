#learn to create equation from https://medium.com/@hva314/some-basic-rsa-challenges-in-ctf-part-2-applying-theoretical-attack-55a2cc7baa11

def b2l(msg):
	return int(msg.hex(), 16)

e = 3
N     =28822588301197007777678939509746560138753350642202095683948415167161367383580378296792771729175432646303708526065928039221354517954673683230517851256764347271791393107289319185675659719294253742682881260584771412583546239123599842849651678109228193456349086356850279461000300784159336095657433958125418562850977085740477255239409458044074781135586740978639847941543231950939139524403075705452006286497244425674556213748737780392226882719779281201397930489995614063510049473893555647232496382115035701101050608928235381359027424164329709554437211344821816382826633100762082343994330377930266603144754220545121527870233
enc   = 10440335734290547921825609338037460614733781107967239419087946873097552255119685010371839134814177218709241579534790256169562144450363550773204086742464557832603571557514243061085566668493154686968293752244577224489184917490826621258092199856956416196828460382861542286472582004981425435364864132245275350523853894599926430590355292757510110142997284294295340399003273366799266479159289551959371112841290529563367670476123220094458576342959669957170337446032291244614094850772088454049706436036697720144661087235681919628612718377869935343593387027328346620881294599035698147511111783914800802344043690420538737860556
start = 248492895719275718569476604052405355739101691263412736004134252211412074288030991099191207760342640338883257179851011400604578388008550192624610859331174283808
end = 245752203663020623195660354139884708858207476913499090692234973174616061345985032820
solution = 693273491941638452870395399734960662527830094436
msg = b2l(b"Here is the secret message which you will never be able to find : \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00 but look like coppersmith is smart")

assert ((msg + solution * 2 ** (8 * 35)) ^ e - enc) % N == 0

P.<x> = Zmod(N)[]
f = (msg + x * 2 ** (8 * 35)) ^ e - enc
print(f.monic().small_roots(beta=0.99))